<!DOCTYPE html>
<html>
<head>
<title>Gold Portfolio Dashboard</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>

body{
font-family:Arial;
background:#f4f6f9;
padding:20px;
}

h1{color:#b8860b;}

.card{
background:white;
padding:20px;
margin-bottom:20px;
border-radius:12px;
box-shadow:0 2px 8px rgba(0,0,0,0.05);
}

input,select{
padding:6px;
border-radius:6px;
border:1px solid #ccc;
}

button{
padding:6px 12px;
border:none;
border-radius:6px;
background:#b8860b;
color:white;
cursor:pointer;
}

table{
width:100%;
border-collapse:collapse;
}

th,td{
padding:10px;
border-bottom:1px solid #eee;
text-align:right;
}

th:first-child,td:first-child{text-align:center;}
th:nth-child(3),td:nth-child(3){text-align:left;}

.green{color:green;font-weight:bold;}
.red{color:red;font-weight:bold;}
.gray{color:gray;}

.chart-container{
max-width:450px;
height:320px;
margin:auto;
}

</style>
</head>
<body>

<h1>ðŸª™ Gold Portfolio Dashboard</h1>

<!-- INPUT -->
<div class="card">

<h3>Tambah Transaksi</h3>

<input type="number" id="gram" placeholder="Gram">
<input type="text" id="type" placeholder="Type">
<input type="number" id="beli" placeholder="Harga Beli">

<select id="status">
<option value="READY">READY</option>
<option value="PO">PO</option>
<option value="SOLD">SOLD</option>
</select>

<button onclick="addData()">Tambah</button>

</div>

<!-- GOLD PRICE -->
<div class="card">

Harga emas per gram:

<input type="number" id="currentPrice" value="1600000">

<button onclick="calculate()">Update</button>

</div>

<!-- SUMMARY -->
<div class="card">

<p>Total Modal Aktif: <span id="modal"></span></p>
<p>Total Realized Profit: <span id="profit"></span></p>
<p>Total Gram Aktif: <span id="gramTotal"></span></p>
<p>Nilai Portofolio: <span id="portfolio"></span></p>
<p>Unrealized P/L: <span id="unreal"></span></p>

</div>

<!-- CHART -->
<div class="card">

<h3>Komposisi Status</h3>

<div class="chart-container">
<canvas id="statusChart"></canvas>
</div>

</div>

<!-- TABLE -->
<div class="card">

<h3>Detail Transaksi</h3>

<table>

<thead>

<tr>
<th>No</th>
<th>Gram</th>
<th>Type</th>
<th>Beli</th>
<th>Jual</th>
<th>Status</th>
<th>Profit</th>
<th>Action</th>
</tr>

</thead>

<tbody id="tableBody"></tbody>

</table>

</div>

<script>

// DEFAULT DATA

const defaultData=[
{gram:5,type:"LM",beli:13500000,jual:15700000,status:"SOLD"},
{gram:8,type:"LM IMLEK 2026",beli:23950800,jual:26500000,status:"SOLD"},
{gram:2,type:"LM",beli:5676000,jual:0,status:"PO"},
{gram:3,type:"LM",beli:9744000,jual:0,status:"PO"},
{gram:0.5,type:"LM WEDDING COUPLE",beli:1633500,jual:0,status:"READY"},
{gram:0.5,type:"LM BABY BOY",beli:1633500,jual:0,status:"READY"},
{gram:0.5,type:"LM BABY GIRL",beli:1633500,jual:0,status:"READY"},
{gram:0.5,type:"LM WEDDING COUPLE",beli:1606500,jual:0,status:"READY"},
{gram:0.5,type:"LM BABY BOY",beli:1606500,jual:0,status:"READY"},
{gram:8,type:"LM IMLEK 2026",beli:24447300,jual:0,status:"READY"}
];

let userData=JSON.parse(localStorage.getItem("userData"))||[];
let statusOverride=JSON.parse(localStorage.getItem("statusOverride"))||{};
let jualOverride=JSON.parse(localStorage.getItem("jualOverride"))||{};

let myChart;


// GET ALL DATA

function getAllData(){

return defaultData.map((item,i)=>({

...item,

status:statusOverride[i]||item.status,

jual:jualOverride[i]??item.jual

})).concat(userData);

}


// SAVE

function saveAll(){

localStorage.setItem("userData",JSON.stringify(userData));
localStorage.setItem("statusOverride",JSON.stringify(statusOverride));
localStorage.setItem("jualOverride",JSON.stringify(jualOverride));

}


// ADD DATA

function addData(){

let gram=parseFloat(document.getElementById("gram").value);
let type=document.getElementById("type").value;
let beli=parseFloat(document.getElementById("beli").value);
let status=document.getElementById("status").value;

let currentPrice=parseFloat(document.getElementById("currentPrice").value);

let jual=status=="SOLD"?gram*currentPrice:0;

userData.push({gram,type,beli,jual,status});

saveAll();
renderTable();
calculate();

}


// UPDATE STATUS

function updateStatus(index,value){

let currentPrice=parseFloat(document.getElementById("currentPrice").value);

if(index<defaultData.length){

statusOverride[index]=value;

if(value=="SOLD" && !jualOverride[index]){

jualOverride[index]=defaultData[index].gram*currentPrice;

}

}else{

let i=index-defaultData.length;

userData[i].status=value;

if(value=="SOLD" && !userData[i].jual){

userData[i].jual=userData[i].gram*currentPrice;

}

}

saveAll();
renderTable();
calculate();

}


// UPDATE JUAL

function updateJual(index,value){

value=parseFloat(value)||0;

if(index<defaultData.length){

jualOverride[index]=value;

}else{

userData[index-defaultData.length].jual=value;

}

saveAll();
calculate();

}


// DELETE USER DATA

function deleteUserData(index){

userData.splice(index,1);

saveAll();
renderTable();
calculate();

}


// RENDER TABLE

function renderTable(){

let data=getAllData();
let tbody=document.getElementById("tableBody");
tbody.innerHTML="";

data.forEach((item,i)=>{

let profit=item.jual-item.beli;

let profitClass=profit>0?"green":profit<0?"red":"gray";

let isSold=item.status=="SOLD";

tbody.innerHTML+=`

<tr>

<td>${i+1}</td>

<td>${item.gram}</td>

<td>${item.type}</td>

<td>Rp ${item.beli.toLocaleString("id-ID")}</td>

<td>

<input type="number"

value="${item.jual||""}"

${isSold?"":"disabled"}

onchange="updateJual(${i},this.value)">

</td>

<td>

<select onchange="updateStatus(${i},this.value)">

<option ${item.status=="READY"?"selected":""}>READY</option>
<option ${item.status=="PO"?"selected":""}>PO</option>
<option ${item.status=="SOLD"?"selected":""}>SOLD</option>

</select>

</td>

<td class="${profitClass}">

${isSold?"Rp "+profit.toLocaleString("id-ID"):"-"}

</td>

<td>

${i<defaultData.length?"ðŸ”’":`<button onclick="deleteUserData(${i-defaultData.length})">Hapus</button>`}

</td>

</tr>

`;

});

}


// CALCULATE

function calculate(){

let price=parseFloat(document.getElementById("currentPrice").value);

let data=getAllData();

let modal=0;
let profit=0;
let gram=0;
let value=0;

let statusCount={READY:0,PO:0,SOLD:0};

data.forEach(item=>{

statusCount[item.status]++;

if(item.status!="SOLD"){

modal+=item.beli;
gram+=item.gram;
value+=item.gram*price;

}else{

profit+=item.jual-item.beli;

}

});

let unreal=value-modal;

document.getElementById("modal").innerHTML="Rp "+modal.toLocaleString("id-ID");
document.getElementById("profit").innerHTML="Rp "+profit.toLocaleString("id-ID");
document.getElementById("gramTotal").innerHTML=gram+" gram";
document.getElementById("portfolio").innerHTML="Rp "+value.toLocaleString("id-ID");

document.getElementById("unreal").innerHTML=
`<span class="${unreal>=0?"green":"red"}">Rp ${unreal.toLocaleString("id-ID")}</span>`;


if(myChart)myChart.destroy();

myChart=new Chart(document.getElementById("statusChart"),{

type:"doughnut",

data:{
labels:Object.keys(statusCount),
datasets:[{
data:Object.values(statusCount),
backgroundColor:["#2ecc71","#f39c12","#3498db"]
}]
},

options:{responsive:true,maintainAspectRatio:false}

});

}


renderTable();
calculate();

</script>

</body>
</html>



